This is spaceFn implementation based on kbfiltr sample by MS (https://github.com/microsoft/Windows-driver-samples/tree/master/input/kbfiltr/sys).

The best dicussion I saw about spaceFn is this one: https://geekhack.org/index.php?topic=51069.0

the kernel implementation is to help avoid competing with other possible keyboard hook applications.

